# SHD (Smart Home Dumbbell) 🏋️‍♂️

SHD는 **IoT 센서와 AI 기술**을 결합하여 집에서도 전문가 수준의 덤벨 운동을 할 수 있도록 도와주는 스마트 홈 트레이닝 솔루션입니다.
실시간 운동 분석뿐만 아니라, **운동 환경(온도, 습도)**까지 고려하여 **GPT-4o 기반의 맞춤형 운동 조언**을 제공합니다.

## ✨ 주요 기능 (Key Features)

### 1. 🧠 AI 기반 환경 분석 및 운동 가이드
- **실시간 온습도 감지**: DHT11 센서가 현재 방 안의 온도와 습도를 `ENV:T,H` 데이터로 수집
- **GPT-4o 스마트 코칭**: 수집된 환경 데이터를 바탕으로 OpenAI GPT-4o가 "현재 환경에서의 최적 운동 팁(수분 섭취, 휴식 등)"을 즉시 생성하여 제공
- **자동화된 프로세스**: 운동 시작 전 자동으로 환경을 분석하고 조언을 건넨 뒤, 준비가 되면 운동 모드로 진입

### 2. 📊 실시간 동작 분석 및 유사도 측정
- **전문가 동작 기록(Expert Mode)**: 사용자가 직접 '올바른 자세'를 수행하여 기준(Baseline) 데이터를 생성
- **실시간 비교(Counting Mode)**: 나의 운동 동작과 전문가의 기준 동작을 실시간으로 비교
- **정밀도(Accuracy) 피드백**: 독자적인 **리샘플링 & 유클리드 거리 알고리즘**을 통해 동작 유사도를 백분율(%)로 표시
- **자동 카운팅**: 올바른 자세로 수행된 횟수(Rep)를 자동으로 감지하고 카운트

### 3. 🖥️ 직관적인 웹 대시보드
- **실시간 그래프**: X, Y, Z축 가속도 변화를 실시간 차트로 시각화
- **상태 모니터링**: 현재 모드(대기/기록/카운팅), 운동 횟수, 유사도 점수, AI 조언을 한 화면에서 확인
- **반응형 UI**: 모바일과 데스크톱 환경 모두에 최적화된 글래스모피즘(Glassmorphism) 디자인

---

## 🛠️ 하드웨어 구성 (Hardware Setup)

| 기기 | 역할 | 부품 |
|---|---|---|
| **메인 컨트롤러** | 데이터 수집 및 전송 | Arduino UNO R4 WiFi (x2) |
| **덤벨 센서** | 움직임(가속도/자이로) 감지 | GY-521 (MPU6050) |
| **환경 센서** | 온도 및 습도 측정 | DHT11 |
| **서버** | 데이터 처리 및 AI 연동 | PC (Python Flask Server) |

### 🔍 센서 연결 및 동작 방식
1. **환경 센서 (Env Device)**
   - 전원 ON 시 자동 WiFi 연결 및 계속해서 `ENV:온도,습도` 데이터 전송
   - 버튼 조작 없이 **상시 작동**
2. **덤벨 센서 (dumbbell Device)**
   - 덤벨에 부착되어 움직임 데이터 (`ax, ay, az...`) 전송
   - **버튼 조작**을 통해 모드 전환 (`보정` → `기록` → `카운팅`)

---

## 🚀 설치 및 실행 (Installation & Run)

### 1. 환경 설정
Python 3.8+ 환경이 필요합니다.
```bash
# 레포지토리 클론
git clone https://github.com/monozu-deving/SHD.git
cd SHD

# 의존성 패키지 설치
pip install -e .
```

### 2. API 키 설정
프로젝트 루트에 `.env` 파일을 생성하고 OpenAI API 키를 입력합니다.
```ini
OPENAI_API_KEY=sk-your-api-key-here
```

### 3. 서버 실행
```bash
cd src/run
python dumbbell.py
```
서버가 시작되면 터미널에 `Waiting for device connections...` 메시지가 표시됩니다.

### 4. 아두이노 연결
- 아두이노 기기들의 전원을 켭니다.
- **온습도 센서**가 먼저 연결되어 환경 데이터를 보내고, AI 조언이 생성됩니다.
- **덤벨 센서**의 버튼을 눌러 운동을 시작합니다.

### 5. 웹 대시보드 접속
브라우저에서 `http://localhost:5000` (또는 PC IP:5000)으로 접속하여 운동 상태를 확인합니다.

---

## 📝 사용 방법 (User Workflow)

1. **준비 단계**: `dumbbell.py` 실행 및 웹 대시보드 접속
2. **환경 분석**: 온습도 센서가 켜지면 자동으로 **"오늘의 운동 팁"**이 화면에 뜹니다.
   - *"현재 습도가 70%로 높으니 평소보다 휴식 시간을 10초 더 가지세요!"*
3. **전문가 모드 (옵션)**: 처음이라면 덤벨 버튼을 눌러 **EXPERT RECORDING**을 시작하고, 정석 자세를 1회 수행하여 저장합니다.
4. **운동 시작**: 다시 버튼을 눌러 **COUNTING** 모드로 진입합니다.
5. **실시간 트레이닝**: 운동을 수행하면 실시간으로 횟수가 올라가고, 자세가 얼마나 정확했는지 점수(%)로 알려줍니다.

`standalone_accel_graph.py`
1. `python standalone_accel_graph.py`실행
2. 그래프 안 뜨면 버튼 눌러서 모드 변경 후 진행


---

## 📂 프로젝트 구조
```
SHD/
├── src/
│   ├── arduino/          # 아두이노 펌웨어 소스
│   │   ├── dumbbell/      # 덤벨 센서 (MPU6050)
│   │   └── temperature/  # 환경 센서 (DHT11)
│   └── run/              # 파이썬 메인 서버
│       └── dumbbell.py    # Flask 서버 + AI 로직 + 데이터 처리
├── ui/                   # 웹 대시보드 리소스 (HTML/CSS/JS)
├── calibration/          # 캘리브레이션 및 기준 데이터 저장소
└── graph/                # 생성된 운동 분석 그래프 저장소
```

## ⚠️ 주의사항
- **방화벽**: 윈도우 방화벽이 5000번 포트를 차단할 경우 아두이노 연결이 안 될 수 있습니다. 인바운드 규칙에 포트 5000 허용을 추가해 주세요.
- **WiFi**: 모든 기기(PC, 아두이노)가 **동일한 WiFi 네트워크(2.4GHz)**에 연결되어 있어야 합니다.
